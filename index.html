<!DOCTYPE html>
<html lang="en" ng-app="barApp">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>FlyingDutchman2016</title>

    <!-- Our own CSS styles -->
    <link rel="stylesheet" href="css/main.css">

    <!-- Angular v1.5.0 -->
    <script src="js/angular.js"></script>
    <script src="js/angular-route.js"></script>
    <!-- jQuery  -->
    <script src="js/jquery-1.12.0.js"></script>
    <!-- Bootstrap -->
    <script src="js/bootstrap.min.js"></script>
    <!-- our own stuff for now -->
    <script src="js/app.js"></script>

    <!-- all controllers and services for now -->
    <script src="js/services.js"></script>
    <script src="js/controller/global-controller.js"></script>
    <script src="js/controller/login-controller.js"></script>
    <script src="js/controller/beer-controller.js"></script>
    <script src="js/controller/home-controller.js"></script>
    <script src="js/controller/order-controller.js"></script>
    <script src="js/controller/TMPadmin-controller.js"></script>

    <script type="text/javascript">
    // TODO: somehow put this into the beer-controller!!!
    function dragstart_handler(ev) {
        console.log("dragStart");

        // Change the source element's background color to signify drag has started
        ev.currentTarget.style.border = "1px dashed white";
        
        // Add the id of the drag source element to the drag data payload so
        // it is available when the drop event is fired
        ev.dataTransfer.setData("text", ev.target.id);

        // Tell the browser both copy and move are possible
        ev.effectAllowed = "copyMove";
    }

    function dragend_handler(ev) {
      console.log("dragend");
      // Restore source's border
      ev.target.style.border = "1px solid #ddd";
      // Remove all of the drag data
      ev.dataTransfer.clearData();
    }

    function dragover_handler(ev) {
        console.log("dragOver");
        ev.currentTarget.style.background = "#eeeeee";
        ev.preventDefault();
    }

    function drop_handler(ev) {
        console.log("Drop");
        ev.preventDefault();

        var data = ev.dataTransfer.getData("text");

        if (data.startsWith("src_copy") == true && ev.target.id == "dest_copy") {
          var node = $('#' + data).clone()
          // TODO: better use some class here that css!!!
          node.css("border: 1px solid #ddd");
          $(ev.target).append(node);

          // find out ID of beer
          var beerID = $('#' + data).data("beerid");

          // add item to cart - local storage
          // TODO: this code should be in some angulare directive to use the service!!!
          var cart = JSON.parse(localStorage.getItem("cart"));
          cart.push({"beer_id": beerID});
          jsonStr = JSON.stringify(cart);
          localStorage.setItem("cart", jsonStr);
        }
    }
    </script>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body ng-controller="GlobalController">

    <div class="container-fluid">

      <!-- Maybe but in some other file/place, so file does not get that long -->
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/#/">FlyingDutchman BeerApp</a>
          </div>

          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
              <li>
                <div class="btn-group btn-group-sm" role="group" aria-label="languages">
                  <button type="button" class="btn btn-default navbar-btn">en</button>
                  <button type="button" class="btn btn-default navbar-btn">de</button>
                </div>
              </li>
              <li class="dropdown">
                <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="fa fa-fw fa-user"></i><span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li class="dropdown-header">Signed in as username {{ AuthService.getLoggedInUser().username }}</li>
                  <li><a href="#">Change themes</a></li>
                  <li><a href="#">Other stuff</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="#" ng-click="logout()">Sign Out</a></li>
                </ul>
              </li>
            </ul>
          </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
      </nav>

      <div class="row">
        <div id="sidebar" class="col-md-2">
          <div class="panel panel-default" id="menu-vip">
            <div class="panel-heading">VIP Menu</div>
            <div class="panel-body">
              <ul class="nav nav-pills nav-stacked">
                <li role="presentation" ng-class="{ active: isActive('/user')}">
                  <a href="#user">All Beers</a>
                </li>
                <li role="presentation" ng-class="{ active: isActive('/todo')}">
                  <a href="#todo">Favorite beers</a>
                </li>
                <li role="presentation" ng-class="{ active: isActive('/last-orders')}">
                  <a href="#last-orders">Last orders</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="panel panel-default" id="menu-admin">
            <div class="panel-heading">Admin Menu</div>
            <div class="panel-body">
              <ul class="nav nav-pills nav-stacked">
                <li role="presentation" ng-class="{ active: isActive('/todo')}">
                  <a href="#todo">Menu Entry 1</a>
                </li>
                <li role="presentation" ng-class="{ active: isActive('/todo')}">
                  <a href="#todo">Menu Entry 2</a>
                </li>
                <li role="presentation" ng-class="{ active: isActive('/todo')}">
                  <a href="#todo">Menu Entry 3</a>
                </li>
              </ul>
            </div>
          </div>



        </div>

        <!-- Main Content Area -->
        <div class="col-md-10">

          <!-- MAIN CONTENT AND INJECTED VIEWS -->
          <div id="main">
            <!-- angular templating -->
            <!-- this is where content will be injected -->
            <div ng-view></div>

          </div>

        </div>
      </div>

    </div>
  </body>
</html>